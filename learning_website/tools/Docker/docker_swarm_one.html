<html><h2><center><u>Docker Swarm - I</u></center>
<h4><pre>
<h3><u>Container Orchestration -</u></h3>
Container Orchestration is the process of deploying and maintaining large number of containers and services for the application to run as intended.

1. Each node of docker swarm is docker daemon, and all the Docker daemons interact using the Docker API.
2. Each container within Swarm can be deployed and accessed by nodes of the same cluster.

Some of the most essential features of Docker Swarm are:
a. Decentralized access: Swarm makes it very easy for teams to access and manage the environment.
b. High Security: Any communication between the manager and client nodes within Swarm is highly secure.
c. Deployment of Containers
d. Scaling
e. Resource allocation
f. AutoLoad Balancing - There is autoload balancing within your environment, and you can that into how you write out and structure the Swarm environment.
g. High Scalabilty: Load Balancing converts the Swarm environment into a highly scalable infrastructure.
h. Roll-back a task: Swarm allows you to roll back the environments to previous safe environments.
i. Health Monitoring

<h3><u>Docker Swarm -</u></h3>
Docker Swarm is a container orchestration tool part of the Docker Engine. With it, developers and IT administrators can deploy and manage a cluster of Docker nodes as a 
single virtual system.

<h3><u>Docker Swarm Components -</u></h3>
Node -> A node is an individual Docker Engine participating in the swarm.
Swarm -> Swarm ss a mode which consists of multiple Docker hosts which run in a cluster.
			
It consists of multiple components as mentioned below :-			
<u>1. Service -></u> Service is the definition of the tasks that needs to be executed on the manager and worker nodes.
Example - which image to use, how many containers to run, which commands to be executed in containers, which Port, Volumes, Networks etc to use 

<u>2. Task -></u> A task carries a Docker container and the commands to run inside the container.

Note 1. Once a task is assigned to a node, it cannot move to another node.
     2. It can only run on the assigned node or fail.

3. Manager Node -> The manager node is responsible for:
	a. Accepting commands and creating service objects
	b. Allocating IP addresses to tasks
	c. Assigning tasks to nodes
	d. Instructing a worker to run a task 
 
4. Worker Node -> Worker Nodes are responsible for checking assigned tasks and executing containers.

<h3><u>Building a Docker Swarm -</u></h3>
1. The Docker engine runs with swarm mode disabled by default, as standalone server.
2. To run Docker in swarm mode, you can either create a new swarm or have the node join an existing swarm.

<u>a. Initializing a Swarm -></u>This command is used to initialize a swarm with a manager.
Example -> docker swarm init --advertise-addr manager_ip

<u>b. Adding a worker to a Swarm -></u>This command is used to join a node into a swarm as a worker.
Example -> docker swarm join --token token_id 

<u>c. To get the command/token to make add of worker node -</u>
Example -> docker swarm join-token worker

<u>d. Check Swarm State -></u> This command can be used to get information about the swarm.
Example -> docker info

<u>e. Display the nodes -></u>This command gives you the list of connected nodes.
Example -> docker node ls

<u>f. Exiting the Swarm-></u>This command can be used from the node terminal to leave a swarm.
Example 1 -> docker swram leave (for worker node)
	2 -> docker swarm leave --force ( for manager node)

<u>g. Remove a node -></u>This command can be used in a manager node terminal to remove a node.
Example 1 -> docker node rm node-id
	2 -> docker node rm -rf 

<h3><u>Docker Swarm Services</u></h3>
A service is used to deploy an application image.

<u>Creating a service -></u> This command is used to create a service.
Example -> $ docker service create --replicas number_of_replicas --publish port_mapping image_name

<u>Listing a service -></u>
Example -> $ docker service ls

<u>Delete a service -></u> This command is used to delete a service.
Example -> $ docker service rm 

<u>Inspect a service -></u> This command is used to obtain information about the service.
Example -> $ docker service inspect --pretty service_id

<u>Listing all nodes running a service -></u> This command can be used to check which nodes are running a service.
Example -> $ docker service ps service_id

Node Status identifies the node participation in the swarm mode.
Status => Node Participation
Blank => Worker Node
Leader => Manager Node(Primary)
Reachable => Candidate to become Leader node(Promote)
Unavailable => Manager node that cannot communicate with other nodes
Drain => Do not assign/create containers

Note 1. You can't have more than one leader within cluster.
     2. You can have multiple reachable machines which are potentially eligible to become later.
     3. If you have mutiple reachable machine then swarm will pick one randomly.
	 
Managing Nodes
$ docker node inspect --pretty Node_id
$ docker node promote Node_id
$ docker node demote
$ docker node update --availability drain Node_id
$ docker node update --availability active Node_id
</pre></h4>
</h2></html>